# 时间：2023-3-31

# 概述
弹窗治理(弹出时机冲突和顺序混乱问题的解决，
使用拦截层+调度中心的分层架构设计，拦截层包括:HOC 拦截器、Redux middleware 拦截器和 AOP 拦截器，
调度中心采用策略模式和优先级任务队列 + 有限状态机配合实现)

# 架构设计：分层架构
## GUI层
- React 弹窗组件（props驱动/Redux驱动）
- android: 运行时权限申请弹窗（[函数式拉起的原生弹窗](https://reactnative.cn/docs/permissionsandroid)）
## 拦截层
- HOC拦截器
  - 拦截props驱动的react弹窗组件
- redux middleware 拦截器
  - 拦截redux驱动的react弹窗组件
- AOP拦截器
  - 拦截android运行时权限申请弹窗
## 调度层
- 优先级策略配置中心（json文件）
- 异步任务调度器
- 优先级任务队列
- 有限状态机
- 异步任务工厂（包装器，统一异步任务的格式：promiseCreator）
## 服务端（面向接口设计原则:面向优先级描述数据扩展）
- 接口
  - 下发配置的优先级策略数据
- 优先级策略配置平台
  - PM之类的可以直接配置弹窗顺序（生成优先级策略数据，写入到后端数据库中）
