<a name="oljKV"></a>
#### 摘录
1. 逻辑层和试图层的通信会由 Native （微信客户端）做中转，逻辑层发送网络请求也经由 Native 转发。
1. 视图层：界面渲染相关的任务全都在 WebView 线程里执行，通过逻辑层代码去控制渲染哪些界面。一个小程序存在多个界面，所以视图层存在多个 WebView 线程由于小程序的渲染层和逻辑层是两个线程管理，两个线程各自注入了基础库。
1. 小程序的基础库不会被打包在某个小程序的代码包里边，它会被提前内置在微信客户端。
1. 小程序冷启动时如果发现有新版本，将会异步下载新版本的代码包，并同时用客户端本地的包进行启动，即新版本的小程序需要等下一次冷启动才会应用上。
   1. 客户端本地包：也就是客户端有一定的缓存机制，冷启动时，会走缓存，缓存无效时才会从CDN中请求包。
5. setData原理：
   1. 小程序的视图层目前使用 WebView 作为渲染载体，而逻辑层是由独立的 JavascriptCore 作为运行环境。在架构上，WebView 和 JavascriptCore 都是独立的模块，并不具备数据直接共享的通道。当前，视图层和逻辑层的数据传输，实际上通过两边提供的 evaluateJavascript 所实现。即用户传输的数据，需要将其转换为字符串形式传递，同时把转换后的数据内容拼接成一份 JS 脚本，再通过执行 JS 脚本的形式传递到两边独立环境。而 evaluateJavascript 的执行会受很多方面的影响，数据到达视图层并不是实时的。
6. 互联网生态演进：超级 APP + 小程序成为「轻应用时代」下的新生态。
6. 商机：小程序方式构建应用是大趋势，被越来越多的企业用户看到其中的优势，构建一个跨多端平台的小程序开发平台是一种思路，帮助企业用户构建一个具备小程序能力的“移动门户”也是一种思路。
6. 双线程架构：PWA中的serviceWork对比于小程序的js逻辑层。
6. 类似于微信 JSSDK 这样的 Hybrid 技术，微信小程序的界面主要由成熟的 Web 技术渲染，辅之以大量的接口提供丰富的客户端原生能力。
6. 每个小程序页面都是用不同的 WebView 去渲染，这样可以提供更好的交互体验，更贴近原生体验，也避免了单个 WebView 的任务过于繁重
<a name="uTY1k"></a>
# 参考

- [小程序原理](https://blog.fundebug.com/2019/05/17/about-wechat-miniprogram-principle/)
- [小程序原理-详解](https://zhaomenghuan.js.org/blog/wechat-miniprogram-principle-analysis.html)
